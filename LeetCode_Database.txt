# LeetCode
# 183. Customers Who Never Order
# Write your MySQL query statement below
SELECT name as Customers
FROM Customers
WHERE id NOT IN (SELECT Customers.id FROM Customers RIGHT JOIN Orders ON Customers.id=Orders.customerId);

# 175. Combine Two Tables
select FirstName, LastName, City, State
from Person left join Address
on Person.PersonId = Address.PersonId;

# 176. Second Highest Salary
SELECT
    (SELECT DISTINCT
            Salary
        FROM
            Employee
        ORDER BY Salary DESC
        LIMIT 1 OFFSET 1) AS SecondHighestSalary
;

# 181. Employees Earning More Than Their Managers
SELECT e.name AS Employee FROM employee e 
INNER JOIN 
employee m ON e.managerid = m.id WHERE e.salary > m.salary;

# 182. Duplicate Emails
SELECT email FROM person
GROUP BY email
HAVING COUNT(email) > 1;

# 184. Department Highest Salary
SELECT d.name as Department, e.name as Employee, e.Salary AS Salary
FROM
(SELECT MAX(e1.salary) AS Salary, e1.DepartmentID FROM Employee e1 GROUP BY e1.departmentID) AS T,
Department d,
Employee e
WHERE
e.salary = t.salary AND d.id = t.departmentID AND d.id = e.departmentID

# 196. Delete Duplicate Emails
# Write your MySQL query statement below
WITH tmp AS
(
SELECT MIN(id) as Id, Email
FROM person
GROUP BY Email
)
DELETE FROM person
WHERE Id NOT IN (SELECT Id FROM tmp);

# Rising Temperature
SELECT w1.id
FROM weather w1
JOIN weather w2
WHERE w1.temperature > w2.temperature
AND DATEDIFF(w1.recorddate, w2.recorddate)=1

# 178. Rank Scores
# Write your MySQL query statement below
select score,
DENSE_RANK() OVER (ORDER BY score DESC) "rank"
from scores;